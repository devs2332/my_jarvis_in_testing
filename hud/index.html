<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JARVIS HUD</title>
    <style>
        body {
            background-color: #000;
            color: #0ff;
            font-family: 'Courier New', Courier, monospace;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            overflow: hidden;
            flex-direction: column;
        }

        .circle {
            width: 300px;
            height: 300px;
            border: 5px solid #0ff;
            border-radius: 50%;
            box-shadow: 0 0 50px #0ff;
            transition: all 0.3s ease;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 24px;
            text-align: center;
            padding: 20px;
        }

        /* States */
        .IDLE {
            border-color: #0ff;
            box-shadow: 0 0 20px #0ff;
            opacity: 0.5;
        }

        .LISTENING {
            border-color: #0f0;
            box-shadow: 0 0 80px #0f0;
            animation: pulse 1s infinite;
        }

        .THINKING {
            border-color: #ff0;
            box-shadow: 0 0 50px #ff0;
            animation: spin 2s infinite linear;
            border-top-color: transparent;
        }

        .SPEAKING {
            border-color: #00f;
            box-shadow: 0 0 100px #00f;
            animation: pulse 0.5s infinite;
        }

        @keyframes pulse {
            0% {
                transform: scale(1);
                opacity: 1;
            }

            50% {
                transform: scale(1.1);
                opacity: 0.8;
            }

            100% {
                transform: scale(1);
                opacity: 1;
            }
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        #status-text {
            margin-top: 30px;
            font-size: 20px;
            max-width: 80%;
            text-align: center;
        }
    </style>
</head>

<body>
    <div id="arc-reactor" class="circle IDLE">JARVIS</div>
    <div id="status-text">WAITING...</div>

    <script>
        const ws = new WebSocket("ws://localhost:8000");
        const reactor = document.getElementById("arc-reactor");
        const statusText = document.getElementById("status-text");

        ws.onopen = () => {
            console.log("Connected to Jarvis");
            statusText.innerText = "SYSTEM ONLINE";
        };

        ws.onmessage = (event) => {
            const data = JSON.parse(event.data);
            const state = data.state;
            const text = data.text;

            console.log("State:", state, "Text:", text);

            // Reset classes
            reactor.className = "circle " + state;

            if (state === "SPEAKING") {
                reactor.innerText = "SPEAKING";
                statusText.innerText = text; // Show what Jarvis says
            } else if (state === "THINKING") {
                reactor.innerText = "THINKING";
                statusText.innerText = "Processing: " + text;
            } else if (state === "LISTENING") {
                reactor.innerText = "LISTENING";
                statusText.innerText = text;
            } else {
                reactor.innerText = "JARVIS";
                statusText.innerText = text || "IDLE";
            }
        };

        ws.onclose = () => {
            statusText.innerText = "CONNECTION LOST";
            reactor.className = "circle";
            reactor.style.borderColor = "red";
        };
    </script>
</body>

</html>